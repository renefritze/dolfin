"""Handles blocking of import of modules"""

__author__ = "Joachim Haga <jobh@broadpark.no>"
__date__ = "2011-01-22 -- 2011-01-22"
__copyright__ = "Copyright (C) 2007-2008 Joachim Haga"
__license__  = "GNU LGPL Version 2.1"

import sys
from dolfin.cpp import error

def block_import_after_dolfin(name, reason):
    prefix = name+'.'
    class Importer(object):
        def find_module(self, fullname, path=None):
            if fullname == name or fullname.startswith(prefix):
                if not name in sys.modules:
                    error('%s must be imported before dolfin (see %s)'%(name, reason))
                return None
    sys.meta_path.append(Importer())

block_import_after_dolfin('PyTrilinos', \
                          'https://bugs.launchpad.net/dolfin/+bug/705401')
