"""This module provides a small Python layer on top of the C++
VariationalProblem/Solver classes as well as the solve function."""

# Copyright (C) 2011 Anders Logg
#
# This file is part of DOLFIN.
#
# DOLFIN is free software: you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# DOLFIN is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License
# along with DOLFIN. If not, see <http://www.gnu.org/licenses/>.
#
# First added:  2011-06-22
# Last changed: 2011-06-22

__all__ = ["LinearVariationalProblem",
           "LinearVariationalSolver",
           "NonlinearVariationalProblem",
           "NonlinearVariationalSolver"]

# Import SWIG-generated extension module (DOLFIN C++)
import dolfin.cpp as cpp

# Local imports
from dolfin.fem.form import Form

# Problem classes need special handling since they involve JIT compilation

class LinearVariationalProblem(cpp.LinearVariationalProblem):

    # Reuse C++ doc-string
    __doc__ = cpp.LinearVariationalProblem.__doc__

    def __init__(self, a, L, u, bcs,
                 form_compiler_parameters=None):
        "Create linear variational problem"

        # Set parameters to empty dictionary if not specified
        form_compiler_parameters = form_compiler_parameters or {}

        # Wrap forms
        a = Form(a, form_compiler_parameters=form_compiler_parameters)
        L = Form(L, form_compiler_parameters=form_compiler_parameters)

        # Initialize base class
        cpp.LinearVariationalProblem.__init__(self, a, L, bcs)

class NonlinearVariationalProblem(cpp.NonlinearVariationalProblem):

    # Reuse C++ doc-string
    __doc__ = cpp.NonlinearVariationalProblem.__doc__

    def __init__(self, F, rhs, u, bcs,
                 form_compiler_parameters=None):
        "Create nonlinear variational problem"

        # Set parameters to empty dictionary if not specified
        form_compiler_parameters = form_compiler_parameters or {}

        # Wrap forms
        F = Form(F, form_compiler_parameters=form_compiler_parameters)

        # Initialize base class
        cpp.NonlinearVariationalProblem.__init__(self, F, rhs, bcs)

# Solver classes are imported directly
from cpp import LinearVariationalSolver, NonlinearVariationalSolver
