# Copyright (C) 2005 Johan Hoffman.
# Licensed under the GNU GPL Version 2.
#
# First added:  2005
# Last changed: 2005
#
# The contiuity equation for the incompressible 
# Navier-Stokes equations using cG(1)cG(1)
#
# Compile this form with FFC: ffc NSEContinuity.form.

name = "NSEContinuity"
scalar_element = FiniteElement("Lagrange", "tetrahedron", 1)
vector_element = FiniteElement("Vector Lagrange", "tetrahedron", 1)
disc_vector_element = FiniteElement("Discontinuous vector Lagrange", "tetrahedron", 0)

q = BasisFunction(scalar_element)
p = BasisFunction(scalar_element)
u = Function(vector_element)
f = Function(vector_element)
uc = Function(disc_vector_element)

d1 = Constant()

i0 = Index()
i1 = Index()
i2 = Index()

a = q.dx(i0)*p.dx(i0)*dx 
L = q.dx(i0)*f[i0]*dx - q.dx(i0)*uc[i1]*u[i0].dx(i1)*dx - (1/d1)*q*u[i0].dx(i0)*dx 

