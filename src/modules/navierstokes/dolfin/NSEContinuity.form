# Copyright (c) 2005 Johan Hoffman (hoffman@cims.nyu.edu)
# Licensed under the GNU GPL Version 2
#
# The contiuity equation for the incompressible 
# Navier-Stokes equations using cG(1)cG(1)
#
# Compile this form with FFC: ffc NSEContinuity.form.

name = "NSEContinuity"
#scalar = FiniteElement("Lagrange", "triangle", 1)
#vector = FiniteElement("Vector Lagrange", "triangle", 1)
#constant_scalar = FiniteElement("Discontinuous Lagrange", "triangle", 0)
#constant_vector = FiniteElement("Discontinuous vector Lagrange", "triangle", 0)
scalar = FiniteElement("Lagrange", "tetrahedron", 1)
vector = FiniteElement("Vector Lagrange", "tetrahedron", 1)
#constant_vector = FiniteElement("Discontinuous vector Lagrange", "tetrahedron", 0)
constant_scalar = FiniteElement("Discontinuous Lagrange", "tetrahedron", 0)

q            = BasisFunction(scalar)
p            = BasisFunction(scalar)
#um           = Function(constant_vector)
uc           = Function(vector)
f            = Function(vector)

delta1       = Function(constant_scalar)        # stabilization

i0 = Index()
i1 = Index()
i2 = Index()

a = delta1*dot(grad(q), grad(p))*dx;
L = delta1*dot(grad(q), f)*dx - q*uc[i0].dx(i0)*dx - delta1*q.dx(i0)*mean(uc[i1])*uc[i0].dx(i1)*dx 
#L = delta1*dot(grad(q), f)*dx - q*uc[i0].dx(i0)*dx - delta1*q.dx(i0)*um[i1]*uc[i0].dx(i1)*dx 

#a = delta1*q.dx(i0)*p.dx(i0)*dx 
#L = delta1*q.dx(i0)*f[i0]*dx - delta1*q.dx(i0)*uc[i1]*uc[i0].dx(i1)*dx - q*uc[i0].dx(i0)*dx 





