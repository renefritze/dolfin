# Copyright (c) 2005 Johan Jansson (johanjan@math.chalmers.se)
# Licensed under the GNU GPL Version 2
#
# First added:  2005
# Last changed: 2006-03-28
#
# The bilinear form for the incompressible Navier-Stokes equations
# Compile this form with FFC: ffc Elasticity.form.

d = 2

K1 = FiniteElement("Vector Lagrange", "triangle", 1)
K2 = FiniteElement("Lagrange", "triangle", 1)
K3 = FiniteElement("Discontinuous Lagrange", "triangle", 0)

v = TestFunction(K1)
dotU = TrialFunction(K1)
U = Function(K1)
P = Function(K2)
f = Function(K1)
nu = Function(K2)
d1 = Function(K3)
d2 = Function(K3)

def ugradu(u, v):
    return [dot(u, grad(v[i])) for i in range(d)]

a = dot(dotU, v) * dx
L = ( -dot(ugradu(U, U), v) +
	dot(P, div(v)) + \
	-mult(nu, dot(grad(U), grad(v))) + \
	mult(d2, dot(div(U), div(v))) + \
	-mult(d1, dot(ugradu(U, U), ugradu(U, v))) + \
        dot(f, v) \
	) * dx
