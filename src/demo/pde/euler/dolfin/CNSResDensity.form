# Copyright (c) 2005 Johan Hoffman (hoffman@cims.nyu.edu)
# Licensed under the GNU GPL Version 2

name = "CNSResDensity"
scalar = FiniteElement("Lagrange", "triangle", 1)
vector = FiniteElement("Vector Lagrange", "triangle", 1)
constant_scalar = FiniteElement("Discontinuous Lagrange", "triangle", 0)


v    = TestFunction(constant_scalar)   # constant scalar test basis function
u    = Function(vector)                 # velocity
rho  = Function(scalar)                 # density
rho0 = Function(scalar)                 # density from previous timestep

vol_inv = Function(constant_scalar)     # the inverse of volume of the element

k  = Constant()         		# time step

# the linear form of the density residual:
#L = ((rho-rho0) / k + div(mult(u, rho))) * vol_inv * v * dx 

L = ((rho-rho0) / k + dot(u, grad(rho)) + dot(rho, grad(u))) * vol_inv * v * dx 

#L = vol_inv * rho * v * dx  +  0.0 *((rho-rho0) / k + dot(u, grad(rho)) + dot(rho, grad(u))) * vol_inv * v * dx 
