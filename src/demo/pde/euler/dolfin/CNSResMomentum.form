# Copyright (c) 2005 Johan Hoffman (hoffman@cims.nyu.edu)
# Licensed under the GNU GPL Version 2

name = "CNSResMomentum"
scalar = FiniteElement("Lagrange", "triangle", 1)
vector = FiniteElement("Vector Lagrange", "triangle", 1)
constant_scalar = FiniteElement("Discontinuous Lagrange", "triangle", 0)
constant_vector = FiniteElement("Discontinuous vector Lagrange", "triangle", 0)


v    =  TestFunction(constant_vector)   # constant scalar test basis function
P    =  Function(scalar)                # pressure
u    =  Function(vector)                # velocity
m    =  Function(vector)                # momentum
m0   =  Function(vector)                # momentum from previous timestep


vol_inv = Function(constant_scalar)     # the inverse of volume of the element

k  = Constant()         		# time step

# the linear form of the momentum residual:
L = mult( 1/k * dot( m-m0, v) +
          (u[0] * m[0]).dx(0) * v[0] + (u[1] * m[0]).dx(1) * v[0] +
          (u[0] * m[1]).dx(0) * v[1] + (u[1] * m[1]).dx(1) * v[1] +
          dot(grad(P), v), vol_inv) * dx

